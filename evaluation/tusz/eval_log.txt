/mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/.venv/lib/python3.10/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
============================================================
SeizureTransformer TUSZ Evaluation
============================================================
Using device: cuda

Loading model...
Model loaded successfully

Loading TUSZ eval data...
Found 865 EDF files in eval set
Found 43 unique subjects

Processing 865 files...
Subjects:   0%|          | 0/43 [00:00<?, ?it/s]Subjects:   2%|▏         | 1/43 [00:24<17:20, 24.78s/it]Subjects:   5%|▍         | 2/43 [00:41<13:48, 20.21s/it]Subjects:   7%|▋         | 3/43 [01:59<30:58, 46.45s/it]Subjects:   9%|▉         | 4/43 [02:08<20:40, 31.81s/it]Subjects:  12%|█▏        | 5/43 [02:27<17:14, 27.23s/it]Subjects:  14%|█▍        | 6/43 [02:44<14:36, 23.68s/it]Subjects:  16%|█▋        | 7/43 [03:49<22:21, 37.26s/it]Subjects:  19%|█▊        | 8/43 [04:01<17:02, 29.20s/it]Subjects:  21%|██        | 9/43 [04:30<16:28, 29.08s/it]Subjects:  23%|██▎       | 10/43 [04:35<11:55, 21.69s/it]Subjects:  26%|██▌       | 11/43 [05:05<12:56, 24.25s/it]Subjects:  28%|██▊       | 12/43 [06:25<21:12, 41.05s/it]Subjects:  30%|███       | 13/43 [06:38<16:13, 32.44s/it]Subjects:  33%|███▎      | 14/43 [06:52<13:07, 27.14s/it]Subjects:  35%|███▍      | 15/43 [07:13<11:45, 25.21s/it]Subjects:  37%|███▋      | 16/43 [09:08<23:25, 52.06s/it]Subjects:  40%|███▉      | 17/43 [09:41<20:07, 46.43s/it]Subjects:  42%|████▏     | 18/43 [10:41<21:03, 50.54s/it]Subjects:  44%|████▍     | 19/43 [10:49<15:07, 37.83s/it]Subjects:  47%|████▋     | 20/43 [11:23<13:58, 36.48s/it]Subjects:  49%|████▉     | 21/43 [11:49<12:17, 33.50s/it]Subjects:  51%|█████     | 22/43 [12:46<14:09, 40.45s/it]Subjects:  53%|█████▎    | 23/43 [12:55<10:21, 31.06s/it]Subjects:  56%|█████▌    | 24/43 [13:41<11:17, 35.64s/it]Subjects:  58%|█████▊    | 25/43 [15:41<18:16, 60.89s/it]Subjects:  60%|██████    | 26/43 [16:15<14:57, 52.81s/it]Subjects:  63%|██████▎   | 27/43 [16:42<12:02, 45.18s/it]Subjects:  65%|██████▌   | 28/43 [16:55<08:51, 35.43s/it]Subjects:  67%|██████▋   | 29/43 [17:30<08:15, 35.36s/it]Subjects:  70%|██████▉   | 30/43 [18:01<07:22, 34.01s/it]Subjects:  72%|███████▏  | 31/43 [18:48<07:33, 37.82s/it]Subjects:  74%|███████▍  | 32/43 [18:55<05:14, 28.55s/it]Subjects:  77%|███████▋  | 33/43 [19:33<05:14, 31.42s/it]Subjects:  79%|███████▉  | 34/43 [20:29<05:49, 38.80s/it]Subjects:  81%|████████▏ | 35/43 [20:46<04:18, 32.34s/it]Subjects:  84%|████████▎ | 36/43 [21:33<04:15, 36.57s/it]Subjects:  86%|████████▌ | 37/43 [22:02<03:27, 34.56s/it]Subjects:  88%|████████▊ | 38/43 [22:39<02:55, 35.19s/it]Subjects:  91%|█████████ | 39/43 [23:28<02:36, 39.19s/it]Subjects:  93%|█████████▎| 40/43 [23:48<01:40, 33.55s/it]Subjects:  95%|█████████▌| 41/43 [24:33<01:13, 36.96s/it]Subjects:  98%|█████████▊| 42/43 [24:40<00:27, 27.89s/it]Subjects: 100%|██████████| 43/43 [25:03<00:00, 26.65s/it]Subjects: 100%|██████████| 43/43 [25:03<00:00, 34.98s/it]
/mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/.venv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:424: UndefinedMetricWarning: Only one class is present in y_true. ROC AUC score is not defined in that case.
  warnings.warn(
Error processing aaaaaaaq_s007_t000.edf: /mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/wu_2025/data/tusz/edf/eval/aaaaaaaq/s007_2014/01_tcp_ar/aaaaaaaq_s007_t000.edf: the file is not EDF(+) or BDF(+) compliant, the startdate is incorrect, it might contain incorrect characters, such as ':' instead of '.'

============================================================
EVALUATION RESULTS
============================================================
Traceback (most recent call last):
  File "/mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/evaluation/tusz/run_tusz_eval.py", line 242, in <module>
    main()
  File "/mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/evaluation/tusz/run_tusz_eval.py", line 213, in main
    metrics = compute_metrics(all_predictions, all_labels)
  File "/mnt/c/Users/JJ/Desktop/Clarity-Digital-Twin/SeizureTransformer/evaluation/tusz/run_tusz_eval.py", line 130, in compute_metrics
    accuracy = np.mean(np.array(y_true) == y_pred_binary)
ValueError: operands could not be broadcast together with shapes (13271040,) (124523520,) 
